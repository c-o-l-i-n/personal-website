import{C as P,H as F,a as C,b as A,c as g,e as u,f as v,g as c,ga as R,i as B,j as N,k as l,l as T,m as $,n as I,na as b,o as d,oa as H,p,q as k,r as S,ra as V,sa as w,ta as W,u as m,v as j,va as h,w as o,y as M}from"./chunk-MVQLXB3M.js";var _={useTransferState:!0,alwaysMonitor:!1,manualIdle:!1,baseURIForScullyContent:"http://localhost:1668"},Z=new P("scullyLibConfig",{factory:()=>_}),f=e=>(e.includes("#")&&(e=e.split("#")[0]),e.includes("?")&&(e=e.split("?")[0]),e.endsWith("/")?e.slice(0,-1):e),L=()=>window&&window.ScullyIO==="running",E=()=>window&&window.ScullyIO==="generated";function z(e,s){return e=e??"",e.endsWith("/")&&s.startsWith("/")?`${e}${s.substr(1)}`:!e.endsWith("/")&&!s.startsWith("/")?`${e}/${s}`:`${e}${s}`}var O="ScullyIO-transfer-state",q="/** ___SCULLY_STATE_START___ */",x="/** ___SCULLY_STATE_END___ */",te="__done__with__Initial__navigation__",ie=(()=>{class e{constructor(t,r,i){this.document=t,this.router=r,this.http=i,this.inlineOnly=!1,this.currentBaseUrl="//",this.stateBS=new C({}),this.state$=this.stateBS.pipe(l(n=>n!==void 0)),this.nextUrl=this.router.events.pipe(l(n=>n instanceof V),p(n=>f(this.initialUrl)===f(n.url)?(this.initialUrl=te,N):u(n)),S(()=>this.stateBS.next(void 0)),p(n=>this.router.events.pipe(l(a=>a instanceof W&&a.url===n.url),$())),c(n=>f(n.urlAfterRedirects||n.url)),d(1))}startMonitoring(){window&&window["ScullyIO-injected"]&&window["ScullyIO-injected"].inlineStateOnly&&(this.inlineOnly=!0),this.setupEnvForTransferState(),this.setupStartNavMonitoring()}setupEnvForTransferState(){if(L()){this.injectScript();let t=window["ScullyIO-exposed"]||{};t.transferState&&(this.stateBS.next(t.transferState),this.saveState(t.transferState))}else this.initialUrl=window.location.pathname||"__no_NO_no__",this.initialUrl=this.initialUrl!=="/"&&this.initialUrl.endsWith("/")?this.initialUrl.slice(0,-1):this.initialUrl,E()&&this.stateBS.next(window&&window[O]||{})}injectScript(){this.script=this.document.createElement("script"),this.script.setAttribute("id",O);let t=this.document.body.lastChild;for(;t.previousSibling.nodeName==="SCRIPT";)t=t.previousSibling;this.document.body.insertBefore(this.script,t)}getState(t){return this.fetchTransferState(),this.state$.pipe(I(t))}stateHasKey(t){return this.stateBS.value&&this.stateBS.value.hasOwnProperty(t)}stateKeyHasValue(t){return this.stateBS.value&&this.stateBS.value.hasOwnProperty(t)&&this.stateBS.value[t]!=null}setState(t,r){let i=Object.assign(Object.assign({},this.stateBS.value),{[t]:r});this.stateBS.next(i),this.saveState(i)}saveState(t){L()&&(this.script.textContent=`{window['${O}']=_u(String.raw\`${q}${ne(JSON.stringify(t))}${x}\`);function _u(t){t=t.split('${q}')[1].split('${x}')[0];const u={'_~b~': "\`",'_~q~': "'",'_~o~': '$','_~s~': '/','_~l~': '<','_~g~': '>'};return JSON.parse(t.replace(/_~d~/g,'\\\\"').replace(/_~[^]~/g, (s) => u[s]).replace(/\\n/g,'\\\\n').replace(/\\t/g,'\\\\t').replace(/\\r/g,'\\\\r'));}}`)}setupStartNavMonitoring(){E()&&this.nextUrl.subscribe()}useScullyTransferState(t,r){return E()?this.getState(t):r.pipe(S(i=>this.setState(t,i)))}fetchTransferState(){return g(this,void 0,void 0,function*(){let t=n=>n.split("/").filter(a=>a.trim()!=="")[0];yield new Promise(n=>setTimeout(n,0));let r=yield v(this.nextUrl),i=t(r);this.currentBaseUrl!==i&&(this.currentBaseUrl=i,this.nextUrl.pipe(k(n=>t(n)===this.currentBaseUrl),p(n=>this.inlineOnly?this.readFromIndex(n):this.readFromJson(n)),T(n=>(console.warn("Error while loading of parsing Scully state:",n),u({}))),S(n=>{this.stateBS.next(n)})).subscribe({complete:()=>{this.currentBaseUrl="//"}}))})}readFromJson(t){return v(this.http.get(J(z(t,"/data.json"))))}readFromIndex(t){return v(this.http.get(J(z(t,"/index.html")),{responseType:"text"})).then(r=>{let i=r.split(q)[1].split(x)[0];return JSON.parse(se(i))})}}return e.\u0275fac=function(t){return new(t||e)(o(R),o(h),o(b))},e.\u0275prov=m({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function J(e){return e.startsWith("/")?e.slice(1):e}function ne(e){let s={"'":"_~q~",$:"_~o~","`":"_~b~","/":"_~s~","<":"_~l~",">":"_~g~"};return e.replace(/[\$`'<>\/]/g,t=>s[t]).replace(/\\\"/g,"_~d~")}function se(e){let s={"_~q~":"'","_~b~":"`","_~o~":"$","_~s~":"/","_~l~":"<","_~g~":">"};return e.replace(/_~d~/g,'\\"').replace(/_~[^]~/g,t=>s[t]).replace(/\n/g,"\\n").replace(/\r/g,"\\r")}var re=(()=>{class e{constructor(t,r,i,n,a){this.zone=t,this.router=r,this.document=n,this.initialUrl=oe(window&&window.location&&window.location.pathname)||"",this.imState=new C({idle:!1,timeOut:5*1e3}),this.idle$=this.imState.pipe(I("idle")),this.initApp=new Event("AngularInitialized",{bubbles:!0,cancelable:!1}),this.appReady=new Event("AngularReady",{bubbles:!0,cancelable:!1}),this.appTimeout=new Event("AngularTimeout",{bubbles:!0,cancelable:!1}),this.scullyLibConfig=Object.assign({},_,i);let K=!!(window["ScullyIO-exposed"]||{}).manualIdle;!this.scullyLibConfig.manualIdle&&window&&(this.scullyLibConfig.alwaysMonitor||L())&&(this.document.dispatchEvent(this.initApp),this.router.events.pipe(l(y=>y instanceof w&&y.urlAfterRedirects!==void 0),l(y=>K?y.urlAfterRedirects!==this.initialUrl:!0),S(()=>this.zoneIdleCheck())).subscribe()),this.scullyLibConfig.manualIdle&&this.document.dispatchEvent(this.initApp),this.scullyLibConfig.useTransferState&&a.startMonitoring()}fireManualMyAppReadyEvent(){return g(this,void 0,void 0,function*(){return this.document.dispatchEvent(this.appReady)})}init(){return v(this.idle$)}zoneIdleCheck(){return g(this,void 0,void 0,function*(){if(Zone===void 0)return this.simpleTimeout();let t=Zone.current.get("TaskTrackingZone");if(t===void 0)return this.simpleTimeout();this.imState.value.idle&&(yield this.setState("idle",!1)),this.zone.runOutsideAngular(()=>{let r,i=0,n=Date.now(),a=()=>{if(clearTimeout(r),Date.now()-n>30*1e3){this.document.dispatchEvent(this.appTimeout);return}if(t.macroTasks.length>0&&t.macroTasks.find(D=>D.source.includes("XMLHttpRequest"))!==void 0||i<1){r=setTimeout(()=>{i+=1,a()},50);return}this.zone.run(()=>{setTimeout(()=>{this.document.dispatchEvent(this.appReady),this.setState("idle",!0)},250)})};a()})})}simpleTimeout(){return g(this,void 0,void 0,function*(){console.warn("Scully is using timeouts, add the needed polyfills instead!"),yield new Promise(t=>setTimeout(t,this.imState.value.timeOut)),this.document.dispatchEvent(this.appReady)})}setPupeteerTimeoutValue(t){this.imState.next(Object.assign(Object.assign({},this.imState.value),{timeOut:t}))}setState(t,r){this.imState.next(Object.assign(Object.assign({},this.imState.value),{[t]:r}))}}return e.\u0275fac=function(t){return new(t||e)(o(F),o(h),o(Z),o(R),o(ie))},e.\u0275prov=m({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function oe(e){return e.endsWith("/")?e.slice(0,-1):e}var G=(()=>{class e{constructor(t,r){this.router=t,this.http=r,this.refresh=new A(1),this.allRoutes$=this.refresh.pipe(p(()=>this.http.get("assets/scully-routes.json")),T(()=>(console.warn("Scully routes file not found, are you running the Scully generated version of your site?"),u([]))),l(i=>Array.isArray(i)),c(this.cleanDups),d({refCount:!1,bufferSize:1})),this.available$=this.allRoutes$.pipe(c(i=>i.filter(n=>n.hasOwnProperty("published")?n.published!==!1:!0)),d({refCount:!1,bufferSize:1})),this.unPublished$=this.allRoutes$.pipe(c(i=>i.filter(n=>n.hasOwnProperty("published")?n.published===!1:!1)),d({refCount:!1,bufferSize:1})),this.topLevel$=this.available$.pipe(c(i=>i.filter(n=>!n.route.slice(1).includes("/"))),d({refCount:!1,bufferSize:1})),this.reload()}getCurrent(){return location?B(u(new w(0,"","")),this.router.events).pipe(l(t=>t instanceof w),p(()=>this.available$),c(t=>{let r=f(encodeURI(location.pathname).trim());return t.find(i=>r===f(i.route.trim())||i.slugs&&Array.isArray(i.slugs)&&i.slugs.find(n=>r.endsWith(f(n.trim()))))})):u()}cleanDups(t){let r=new Map;return t.forEach(i=>r.set(JSON.stringify(Object.assign(Object.assign({},i),{route:ae(i)?"":i.route})),i)),[...r.values()]}reload(){this.refresh.next()}}return e.\u0275fac=function(t){return new(t||e)(o(h),o(b))},e.\u0275prov=m({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function ae(e){let s=Object.keys(e);return!(s.length===1&&s.includes("route")||s.length===2&&s.includes("route")&&s.includes("title"))}var Y=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=M({type:e}),e.\u0275inj=j({}),e})(),Re=(()=>{class e{constructor(t){this.idle=t}static forRoot(t=_){return t=Object.assign({},_,t),{ngModule:e,providers:[{provide:Z,useValue:t}]}}}return e.\u0275fac=function(t){return new(t||e)(o(re))},e.\u0275mod=M({type:e}),e.\u0275inj=j({imports:[[Y,H],Y]}),e})();function Oe(e,s){return new Date(s.publishedDate).getTime()-new Date(e.publishedDate).getTime()}var ue={route:"/blog/mock-blog-post-1",title:"Mock Blog Post 1",description:"This is a fake blog post",thumbnail:"https://picsum.photos/600",publishedDate:"2022-05-20",featured:!0,tags:["Angular"]},le={route:"/blog/mock-blog-post-2",title:"Mock Blog Post 2",description:"This is another fake blog post",thumbnail:"https://picsum.photos/600",publishedDate:"2023-09-02",featured:!1,tags:["Firebase"]},U=[ue,le];var Ae=(()=>{let s=class s extends G{constructor(r,i){super(r,i),this.router2=r,this.available$=u(U)}getCurrent(){return u(U.find(r=>r.route===this.router2.url))}};s.\u0275fac=function(i){return new(i||s)(o(h),o(b))},s.\u0275prov=m({token:s,factory:s.\u0275fac,providedIn:"root"});let e=s;return e})();export{G as a,Re as b,Oe as c,Ae as d};
